#include <stdio.h>
#include <math.h>
#include <float.h>

#define MAX 10

// Structure to represent a city (x, y)
typedef struct {
    double x, y;
} City;

// Function to calculate Euclidean distance between two cities
double distance(City a, City b) {
    return sqrt((a.x - b.x) * (a.x - b.x) + (a.y - b.y) * (a.y - b.y));
}

// Swap function for permutation generation
void swap(int *a, int *b) {
    int temp = *a;
    *a = *b;
    *b = temp;
}

// Function to calculate total distance of a route
double calcRouteDistance(City cities[], int path[], int n) {
    double total = 0;
    for (int i = 0; i < n - 1; i++)
        total += distance(cities[path[i]], cities[path[i + 1]]);
    total += distance(cities[path[n - 1]], cities[path[0]]); // Return to start
    return total;
}

// Recursive function to find the best route
void tsp(City cities[], int path[], int start, int n, double *minDist, int bestPath[]) {
    if (start == n - 1) {
        double total = calcRouteDistance(cities, path, n);
        if (total < *minDist) {
            *minDist = total;
            for (int i = 0; i < n; i++)
                bestPath[i] = path[i];
        }
        return;
    }

    for (int i = start; i < n; i++) {
        swap(&path[start], &path[i]);
        tsp(cities, path, start + 1, n, minDist, bestPath);
        swap(&path[start], &path[i]); // backtrack
    }
}

// Function to run and print results for a test case
void runTestCase(City cities[], int n, int testCaseNum) {
    int path[MAX], bestPath[MAX];
    for (int i = 0; i < n; i++)
        path[i] = i;

    double minDist = DBL_MAX;

    tsp(cities, path, 1, n, &minDist, bestPath);

    printf("\nTest Case %d:\n", testCaseNum);
    printf("Shortest Distance: %.15f\n", minDist);
    printf("Shortest Path: [");
    for (int i = 0; i < n; i++)
        printf("(%.1f, %.1f), ", cities[bestPath[i]].x, cities[bestPath[i]].y);
    printf("(%.1f, %.1f)]\n", cities[bestPath[0]].x, cities[bestPath[0]].y);
}

// Main function
int main() {
    // ---------- Test Case 1 ----------
    City cities1[] = {
        {1, 2}, {4, 5}, {7, 1}, {3, 6}
    };
    int n1 = 4;
    runTestCase(cities1, n1, 1);

    // ---------- Test Case 2 ----------
    City cities2[] = {
        {2, 4}, {8, 1}, {1, 7}, {6, 3}, {5, 9}
    };
    int n2 = 5;
    runTestCase(cities2, n2, 2);

    return 0;
}
